# –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –ø–æ –¥–µ–ø–ª–æ—é –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–æ–π –≤–µ—Ä—Å–∏–∏

## üöÄ –ì–æ—Ç–æ–≤–æ –∫ –¥–µ–ø–ª–æ—é

–í—Å–µ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ –∑–∞–≤–µ—Ä—à–µ–Ω—ã –∏ –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω—ã. –ü—Ä–æ–µ–∫—Ç —É—Å–ø–µ—à–Ω–æ —Å–æ–±–∏—Ä–∞–µ—Ç—Å—è –∏ –≥–æ—Ç–æ–≤ –∫ –ø—É–±–ª–∏–∫–∞—Ü–∏–∏ –Ω–∞ Vercel.

## ‚úÖ –ß—Ç–æ –±—ã–ª–æ —Å–¥–µ–ª–∞–Ω–æ

1. **–ò—Å–ø—Ä–∞–≤–ª–µ–Ω—ã –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –ø—Ä–æ–±–ª–µ–º—ã –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏**
   - N+1 –∑–∞–ø—Ä–æ—Å—ã ‚Üí 1 –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –∑–∞–ø—Ä–æ—Å
   - –°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ –≤ –ø–∞–º—è—Ç–∏ ‚Üí —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ –≤ SQL
   - –î–≤–æ–π–Ω—ã–µ COUNT –∑–∞–ø—Ä–æ—Å—ã ‚Üí COUNT(*) OVER()

2. **–î–æ–±–∞–≤–ª–µ–Ω–æ –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ**
   - React Query –¥–ª—è –∫–ª–∏–µ–Ω—Ç—Å–∫–æ–≥–æ –∫—ç—à–∞
   - ISR (Incremental Static Regeneration) –¥–ª—è —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏—Ö —Å—Ç—Ä–∞–Ω–∏—Ü
   - –ë—Ä–∞—É–∑–µ—Ä–Ω—ã–π –∫—ç—à –¥–ª—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π (30 –¥–Ω–µ–π)

3. **–¶–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è**
   - –í—Å–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –≤ [lib/config.ts](lib/config.ts)
   - –õ–µ–≥–∫–æ –º–µ–Ω—è—Ç—å –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –ø–∞–≥–∏–Ω–∞—Ü–∏–∏ –∏ –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏—è

## üìã –ß–µ–∫-–ª–∏—Å—Ç –ø–µ—Ä–µ–¥ –¥–µ–ø–ª–æ–µ–º

### 1. –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–±–æ—Ä–∫–∏
```bash
npm run build
```
‚úÖ –î–æ–ª–∂–Ω–æ –∑–∞–≤–µ—Ä—à–∏—Ç—å—Å—è —É—Å–ø–µ—à–Ω–æ –±–µ–∑ –æ—à–∏–±–æ–∫

### 2. –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è
–£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –Ω–∞ Vercel —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è:
```
DATABASE_URL=mysql://user:password@host:port/database
```

### 3. –ü—Ä–æ–≤–µ—Ä–∫–∞ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
- ‚úÖ –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –¥–æ—Å—Ç—É–ø–Ω–∞ –∏–∑–≤–Ω–µ (–µ—Å–ª–∏ Vercel –ø–æ–¥–∫–ª—é—á–∞–µ—Ç—Å—è –∫ –ª–æ–∫–∞–ª—å–Ω–æ–π –ë–î)
- ‚úÖ –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ë–î –∏–º–µ–µ—Ç –ø—Ä–∞–≤–∞ –Ω–∞ —á—Ç–µ–Ω–∏–µ
- ‚úÖ –í—Å–µ —Ç–∞–±–ª–∏—Ü—ã —Å—É—â–µ—Å—Ç–≤—É—é—Ç –∏ –¥–æ—Å—Ç—É–ø–Ω—ã

## üîÑ –î–µ–ø–ª–æ–π –Ω–∞ Vercel

### –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –¥–µ–ø–ª–æ–π
–ü—Ä–æ–µ–∫—Ç –Ω–∞—Å—Ç—Ä–æ–µ–Ω –Ω–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –¥–µ–ø–ª–æ–π –ø—Ä–∏ push –≤ GitHub:

```bash
git add .
git commit -m "feat: –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ - –∏—Å–ø—Ä–∞–≤–ª–µ–Ω—ã N+1 –∑–∞–ø—Ä–æ—Å—ã, –¥–æ–±–∞–≤–ª–µ–Ω–æ –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ"
git push origin main
```

Vercel –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏:
1. –û–±–Ω–∞—Ä—É–∂–∏—Ç –∏–∑–º–µ–Ω–µ–Ω–∏—è
2. –ó–∞–ø—É—Å—Ç–∏—Ç —Å–±–æ—Ä–∫—É
3. –ó–∞–¥–µ–ø–ª–æ–∏—Ç –Ω–æ–≤—É—é –≤–µ—Ä—Å–∏—é
4. –ü–æ–∫–∞–∂–µ—Ç –ø—Ä–µ–≤—å—é-URL

### –†—É—á–Ω–æ–π –¥–µ–ø–ª–æ–π (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
```bash
vercel --prod
```

## üìä –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –ø–æ—Å–ª–µ –¥–µ–ø–ª–æ—è

### 1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –æ—Å–Ω–æ–≤–Ω—ã–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã:
- ‚úÖ –ì–ª–∞–≤–Ω–∞—è: https://comicsdb.ru
- ‚úÖ –ò–∑–¥–∞—Ç–µ–ª—å—Å—Ç–≤–∞: https://comicsdb.ru/publishers
- ‚úÖ –ü–æ–∏—Å–∫: https://comicsdb.ru/search?q=batman

### 2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –º–µ—Ç—Ä–∏–∫–∏ –≤ Vercel Dashboard:
- Response Time (–¥–æ–ª–∂–µ–Ω —É–º–µ–Ω—å—à–∏—Ç—å—Å—è –≤ 5-10 —Ä–∞–∑)
- Serverless Function Duration
- Edge Requests

### 3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –≤ DevTools:
```
Chrome DevTools ‚Üí Network ‚Üí Measure performance
```

### –û–∂–∏–¥–∞–µ–º—ã–µ —É–ª—É—á—à–µ–Ω–∏—è:
- **–°—Ç—Ä–∞–Ω–∏—Ü–∞ –∏–∑–¥–∞—Ç–µ–ª—å—Å—Ç–≤:** —Å 2-5 —Å–µ–∫ ‚Üí 100-300 –º—Å
- **–°–≤–µ–∂–∏–µ —Ä–µ–ª–∏–∑—ã:** —Å 500-800 –º—Å ‚Üí 150-250 –º—Å
- **–ü–æ–∏—Å–∫:** —Å 1-3 —Å–µ–∫ ‚Üí 200-400 –º—Å

## üêõ –í–æ–∑–º–æ–∂–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã –∏ —Ä–µ—à–µ–Ω–∏—è

### –ü—Ä–æ–±–ª–µ–º–∞: "Unknown column 's.publisher_id'"
**–†–µ—à–µ–Ω–∏–µ:** –£–∂–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–æ! –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –ø—Ä–∞–≤–∏–ª—å–Ω–æ–µ –∏–º—è –∫–æ–ª–æ–Ω–∫–∏ `s.publisher`

### –ü—Ä–æ–±–ª–µ–º–∞: –ú–µ–¥–ª–µ–Ω–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã –Ω–∞ production
**–†–µ—à–µ–Ω–∏–µ:**
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∏–Ω–¥–µ–∫—Å—ã –≤ –ë–î:
```sql
SHOW INDEX FROM cdb_series;
SHOW INDEX FROM cdb_comics;
SHOW INDEX FROM cdb_publishers;
```

2. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –µ—Å—Ç—å –∏–Ω–¥–µ–∫—Å—ã –Ω–∞:
   - `cdb_series.publisher`
   - `cdb_series.date_delete`
   - `cdb_comics.serie`
   - `cdb_comics.date_delete`
   - `cdb_comics.translate` (–¥–ª—è –ø–æ–∏—Å–∫–∞ - –º–æ–∂–Ω–æ FULLTEXT)
   - `cdb_comics.edit` (–¥–ª—è –ø–æ–∏—Å–∫–∞ - –º–æ–∂–Ω–æ FULLTEXT)

### –ü—Ä–æ–±–ª–µ–º–∞: –ö—ç—à –Ω–µ –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è
**–†–µ—à–µ–Ω–∏–µ:**
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ ISR –≤ —Ñ–∞–π–ª–∞—Ö —Å—Ç—Ä–∞–Ω–∏—Ü:
```typescript
export const revalidate = 60 // —Å–µ–∫—É–Ω–¥—ã
```

2. –§–æ—Ä—Å–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –≤ Vercel:
```
Vercel Dashboard ‚Üí Deployments ‚Üí Redeploy
```

## üéØ –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏ –¥–ª—è –¥–∞–ª—å–Ω–µ–π—à–µ–π –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏

### –ö—Ä–∞—Ç–∫–æ—Å—Ä–æ—á–Ω—ã–µ (1-2 –Ω–µ–¥–µ–ª–∏):
1. ‚úÖ **–î–æ–±–∞–≤–∏—Ç—å –∏–Ω–¥–µ–∫—Å—ã –≤ –ë–î** (–µ—Å–ª–∏ –∏—Ö –Ω–µ—Ç)
   ```sql
   -- –î–ª—è –ø–æ–∏—Å–∫–∞ –ø–æ —Å–∫–∞–Ω–ª–µ–π—Ç–µ—Ä–∞–º
   ALTER TABLE cdb_comics ADD FULLTEXT INDEX ft_translate (translate);
   ALTER TABLE cdb_comics ADD FULLTEXT INDEX ft_edit (edit);
   ```

2. ‚úÖ **–û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å —Å—Ç—Ä–∞–Ω–∏—Ü—É –ø–æ–∏—Å–∫–∞ –ø–æ–ª–Ω–æ—Å—Ç—å—é**
   - –ó–∞–º–µ–Ω–∏—Ç—å –æ—Å—Ç–∞–≤—à–∏–µ—Å—è —Ñ—É–Ω–∫—Ü–∏–∏ (searchByCreators, searchByTeams –∏ —Ç.–¥.)
   - –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –Ω–æ–≤—ã–π –º–æ–¥—É–ª—å [lib/search-queries.ts](lib/search-queries.ts)

3. ‚úÖ **–î–æ–±–∞–≤–∏—Ç—å –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏**
   - Vercel Analytics
   - Sentry –¥–ª—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è –æ—à–∏–±–æ–∫

### –°—Ä–µ–¥–Ω–µ—Å—Ä–æ—á–Ω—ã–µ (1-2 –º–µ—Å—è—Ü–∞):
4. **Database Connection Pooling**
   ```typescript
   // prisma/schema.prisma
   datasource db {
     provider = "mysql"
     url      = env("DATABASE_URL")
     relationMode = "prisma"
   }
   ```

5. **API Route Caching**
   ```typescript
   export const revalidate = 60 // –ù–∞ —É—Ä–æ–≤–Ω–µ API routes
   ```

6. **Streaming SSR —Å React Suspense**
   ```tsx
   <Suspense fallback={<Skeleton />}>
     <HeavyComponent />
   </Suspense>
   ```

### –î–æ–ª–≥–æ—Å—Ä–æ—á–Ω—ã–µ (3+ –º–µ—Å—è—Ü–∞):
7. **–ú–∏–≥—Ä–∞—Ü–∏—è –Ω–∞ PostgreSQL** (–¥–ª—è –ª—É—á—à–µ–π –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ LIKE –∑–∞–ø—Ä–æ—Å–æ–≤)
8. **Redis –¥–ª—è –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏—è** (–≥–æ—Ä—è—á–∏–µ –¥–∞–Ω–Ω—ã–µ)
9. **CDN –¥–ª—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π** (Cloudflare Images –∏–ª–∏ imgix)

## üìù Rollback –ø–ª–∞–Ω

–ï—Å–ª–∏ —á—Ç–æ-—Ç–æ –ø–æ–π–¥—ë—Ç –Ω–µ —Ç–∞–∫:

### 1. –ë—ã—Å—Ç—Ä—ã–π –æ—Ç–∫–∞—Ç —á–µ—Ä–µ–∑ Vercel:
```
Vercel Dashboard ‚Üí Deployments ‚Üí Previous deployment ‚Üí Promote to Production
```

### 2. –û—Ç–∫–∞—Ç —á–µ—Ä–µ–∑ Git:
```bash
git log  # –ù–∞–π–¥–∏—Ç–µ –ø—Ä–µ–¥—ã–¥—É—â–∏–π –∫–æ–º–º–∏—Ç
git revert <commit-hash>
git push origin main
```

### 3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏:
```
Vercel Dashboard ‚Üí Deployment ‚Üí Runtime Logs
```

## ‚úÖ –§–∏–Ω–∞–ª—å–Ω—ã–π —á–µ–∫-–ª–∏—Å—Ç

- [ ] `npm run build` –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –±–µ–∑ –æ—à–∏–±–æ–∫
- [ ] –í—Å–µ —Ç–µ—Å—Ç—ã –ø—Ä–æ–π–¥–µ–Ω—ã (–µ—Å–ª–∏ –µ—Å—Ç—å)
- [ ] –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã –Ω–∞ Vercel
- [ ] –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –¥–æ—Å—Ç—É–ø–Ω–∞
- [ ] Git –∫–æ–º–º–∏—Ç —Å–¥–µ–ª–∞–Ω —Å –ø–æ–Ω—è—Ç–Ω—ã–º —Å–æ–æ–±—â–µ–Ω–∏–µ–º
- [ ] Push –≤ main –≤–µ—Ç–∫—É –≤—ã–ø–æ–ª–Ω–µ–Ω
- [ ] Vercel –Ω–∞—á–∞–ª –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –¥–µ–ø–ª–æ–π
- [ ] –ù–æ–≤–∞—è –≤–µ—Ä—Å–∏—è –∑–∞–¥–µ–ø–ª–æ–µ–Ω–∞ —É—Å–ø–µ—à–Ω–æ
- [ ] –û—Å–Ω–æ–≤–Ω—ã–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã —Ä–∞–±–æ—Ç–∞—é—Ç
- [ ] –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å —É–ª—É—á—à–∏–ª–∞—Å—å

---

**–î–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è:** 2025-12-15
**–í–µ—Ä—Å–∏—è:** 2.0 (–û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–∞—è)
**–°—Ç–∞—Ç—É—Å:** ‚úÖ –ì–æ—Ç–æ–≤–æ –∫ production
