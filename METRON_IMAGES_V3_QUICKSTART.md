# üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç: –ü–æ–¥–º–µ–Ω–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π Metron (–§–∏–Ω–∞–ª—å–Ω–∞—è –≤–µ—Ä—Å–∏—è)

## –ü—Ä–∏–Ω—Ü–∏–ø —Ä–∞–±–æ—Ç—ã

1. ‚úÖ **–ù–æ–≤—ã–π —Ñ–æ—Ä–º–∞—Ç ComicVine** (`/a/uploads/`) ‚Üí –∏—Å–ø–æ–ª—å–∑—É–µ–º –∫–∞–∫ –µ—Å—Ç—å
2. ‚úÖ **–°—Ç–∞—Ä—ã–π —Ñ–æ—Ä–º–∞—Ç** (`api/image/`) ‚Üí –ø—Ä–æ–≤–µ—Ä—è–µ–º Metron API
3. ‚úÖ **–ò—Å–ø–æ–ª—å–∑—É–µ–º –ø–æ–ª–µ `image`** –∏–∑ –æ—Ç–≤–µ—Ç–∞ API –Ω–∞–ø—Ä—è–º—É—é
4. ‚úÖ **–ö—ç—à–∏—Ä—É–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã** ‚Üí –∏–∑–±–µ–≥–∞–µ–º –ø–æ–≤—Ç–æ—Ä–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤
5. ‚úÖ **–°–æ–±–ª—é–¥–∞–µ–º –ª–∏–º–∏—Ç—ã** ‚Üí 4 —Å–µ–∫ –º–µ–∂–¥—É –∑–∞–ø—Ä–æ—Å–∞–º–∏ = 15 –∑–∞–ø—Ä–æ—Å–æ–≤/–º–∏–Ω

## –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

### –í —Å–µ—Ä–≤–µ—Ä–Ω—ã—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞—Ö (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)

```typescript
import { getImageUrlWithMetron } from '@/lib/metron-api'

const thumb = await getImageUrlWithMetron(comic.thumb, comic.comicvine, 'thumb')
```

### –í –∫–ª–∏–µ–Ω—Ç—Å–∫–∏—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞—Ö

```typescript
import { getImageUrl } from '@/lib/utils'

const url = getImageUrl(comic.thumb, comic.comicvine, 'thumb')
```

## –§–æ—Ä–º–∞—Ç URL

### –ù–æ–≤—ã–π —Ñ–æ—Ä–º–∞—Ç (–Ω–µ –ø—Ä–æ–≤–µ—Ä—è–µ–º Metron)
```
https://comicvine.gamespot.com/a/uploads/scale_large/12345.jpg
```

### –°—Ç–∞—Ä—ã–π —Ñ–æ—Ä–º–∞—Ç (–ø—Ä–æ–≤–µ—Ä—è–µ–º Metron)
```
https://comicvine.gamespot.com/api/image/scale_large/12345.jpg
```

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–∞–Ω–Ω—ã—Ö

```json
{
  "cachedIds": ["4050-12345"],  // –ù–∞–π–¥–µ–Ω–æ –≤ Metron
  "checkedIds": ["4050-11111"]  // –£–∂–µ –ø—Ä–æ–≤–µ—Ä—è–ª–∏ (–≤–∫–ª—é—á–∞—è –Ω–µ –Ω–∞–π–¥–µ–Ω–Ω—ã–µ)
}
```

## –õ–∏–º–∏—Ç—ã API

- **4 —Å–µ–∫—É–Ω–¥—ã –º–µ–∂–¥—É –∑–∞–ø—Ä–æ—Å–∞–º–∏** = 15 –∑–∞–ø—Ä–æ—Å–æ–≤/–º–∏–Ω (–±–µ–∑–æ–ø–∞—Å–Ω—ã–π –∑–∞–ø–∞—Å)
- **10000 –∑–∞–ø—Ä–æ—Å–æ–≤/–¥–µ–Ω—å** = –º–∞–∫—Å–∏–º—É–º ~9000 (—Å –∑–∞–ø–∞—Å–æ–º)

–°–∏—Å—Ç–µ–º–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–æ–±–ª—é–¥–∞–µ—Ç –ª–∏–º–∏—Ç—ã —á–µ—Ä–µ–∑ –æ—á–µ—Ä–µ–¥—å –∑–∞–ø—Ä–æ—Å–æ–≤.

## –î–≤–∞ –ø–æ–¥—Ö–æ–¥–∞

### 1. On-Demand (–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏)
–ü—Ä–∏ –æ–±—Ä–∞—â–µ–Ω–∏–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∫ –∫–æ–º–∏–∫—Å—É —Å–æ —Å—Ç–∞—Ä—ã–º —Ñ–æ—Ä–º–∞—Ç–æ–º - –ø—Ä–æ–≤–µ—Ä—è–µ–º Metron.

### 2. Background (—Å–∫—Ä–∏–ø—Ç)
```bash
# –û–±—Ä–∞–±–æ—Ç–∞—Ç—å –≤—Å–µ –∫–æ–º–∏–∫—Å—ã (–∑–∞–π–º–µ—Ç ~5 –¥–Ω–µ–π)
npx tsx scripts/process-metron-images-background.ts

# –û–±—Ä–∞–±–æ—Ç–∞—Ç—å —Ç–æ–ª—å–∫–æ 100 –ø–æ–ø—É–ª—è—Ä–Ω—ã—Ö
npx tsx scripts/process-metron-images-background.ts --limit=100
```

## –ü—Ä–∏–º–µ—Ä—ã –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –∫–æ–¥–∞

### –î–æ
```typescript
const thumb = getImageUrl(comic.thumb)
```

### –ü–æ—Å–ª–µ (—Å–µ—Ä–≤–µ—Ä–Ω—ã–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç)
```typescript
const thumb = await getImageUrlWithMetron(comic.thumb, comic.comicvine, 'thumb')
```

### –ü–æ—Å–ª–µ (–∫–ª–∏–µ–Ω—Ç—Å–∫–∏–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç)
```typescript
const thumb = getImageUrl(comic.thumb, comic.comicvine, 'thumb')
```

## –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç—ã

1. –û—Ç–∫—Ä–æ–π—Ç–µ —Å—Ç—Ä–∞–Ω–∏—Ü—É –∫–æ–º–∏–∫—Å–∞
2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ Network tab –≤ DevTools
3. –î–ª—è —Å—Ç–∞—Ä–æ–≥–æ —Ñ–æ—Ä–º–∞—Ç–∞ –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å:
   - –õ–∏–±–æ Metron URL (–µ—Å–ª–∏ –Ω–∞–π–¥–µ–Ω–æ)
   - –õ–∏–±–æ –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω—ã–π ComicVine URL (–µ—Å–ª–∏ –Ω–µ –Ω–∞–π–¥–µ–Ω–æ)

## –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

–ü–æ–ª–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è: [docs/METRON_IMAGES_V3.md](docs/METRON_IMAGES_V3.md)

